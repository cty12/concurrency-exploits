--- build.sh
+++ build.sh
@@ -121,10 +121,16 @@
 echo "SNAPPY_PATH=$SNAPPY_PATH" >> build_config.mk
 
 echo "CFLAGS = $CFLAGS" >> build_config.mk
-echo "CFLAGS += -DNDEBUG -D__STDC_FORMAT_MACROS -Wall -O2 -Wno-sign-compare" >> build_config.mk
+echo "CFLAGS += -fsanitize=thread -D__STDC_FORMAT_MACROS -Wall -O0 -Wno-sign-compare" >> build_config.mk
 echo "CFLAGS += ${PLATFORM_CFLAGS}" >> build_config.mk
 echo "CFLAGS += -I \"$LEVELDB_PATH/include\"" >> build_config.mk
 
+echo "CXXFLAGS = $CFLAGS" >> build_config.mk
+echo "CXXFLAGS += -fsanitize=thread -O0 " >> build_config.mk
+
+echo "LDFLAGS = $LDLAGS" >> build_config.mk
+echo "LDFLAGS += -fsanitize=thread" >> build_config.mk
+
 echo "CLIBS=" >> build_config.mk
 echo "CLIBS += ${PLATFORM_CLIBS}" >> build_config.mk
 echo "CLIBS += \"$LEVELDB_PATH/libleveldb.a\"" >> build_config.mk
