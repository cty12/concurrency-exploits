Here are two bugs involved, you can see them on
http://www.exploit-db.com/exploits/9859/
http://www.exploit-db.com/exploits/9488/

The following reproduce process has been tested in Linux 64-bit, multi core processor.
I think other OS should also work, but multi-core processor may be indispensable.

Steps:
0. Download FreeBSD 6.0-release
wget http://ftp-archive.freebsd.org/pub/FreeBSD-Archive/old-releases/i386/ISO-IMAGES/6.0/6.0-RELEASE-i386-disc1.iso
1. Install VMWare workstation (VirtualBox may also work)
2. Create New Virtual Machine -> Typical -> USE ISO image -> Other FreeBSD
3. Customize Hardware -> Number of processors : 4
4. Boot FreeBSD ISO, select default boot option
5. Standard -> OK -> OK -> Use Entire Disk -> Finish -> Standard -> OK -> Auto Defaults -> Finish -> All -> Yes -> OK -> OK -> Yes
6. OK -> Yes -> No IPV6 -> Yes DHCP -> OK -> No.....No -> User Confirmation Requested YES! -> User -> Login ID (your username), Password (your password), Login shell (/bin/tcsh) -> OK -> Exit -> OK -> Root password -> No -> Exit Install -> Yes -> Remove the CD
7. Now the system should start, login use root
8. vi /etc/make.conf, add those two lines:
NO_CLEAN=yes
KERNCONF=SMP
9.
cd /usr/src
make buildkernel
make installkernel
reboot

now, if you run 'sysctl -a |grep ncpu' should show a number > 1

10. get and Compile the malicious code
You should change to another tty and login as a normal user
scp user@host:~/bug*.c .
gcc bug1.c -o bug1 -pthread
gcc bug2.c -o bug2 -pthread

11a. Obtain the root shell (bug1)
You should change to another tty and login as a normal user
./bug1
This bug will always succeed

11b. Obtain the root shell (bug1)
You should change to another tty and login as a normal user
./bug2
This bug will not always succeed. Try it on different ttys. Success rate in my testing environment is ~10%
