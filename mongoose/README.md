# Mongoose-3.6

### Step 1: Run ```mk.sh``` in the source code, you will decompress the mongoose and go to that folder
```
cd /your/folder
./mk.sh
```

### Step 2: Follow the same steps to install [llvm-3.7.1.src](https://github.com/ruigulala/ConAnalysis#install-llvm-361--clang-361)

### Step 3: Download the patches in source code to hack ```llvm-3.7.1.src``` before building the llvm
```
cd /your/path/llvm-3.7.1.src/projects/compiler-rt
patch -p1 < compiler-rt.patch --dry-run (to check)
patch -p1 < compiler-rt.patch (to patch)
cd /your/path/llvm-3.7.1.src
patch -p1 < llvm.patch --dry-run (to check)
patch -p1 < llvm.patch (to patch)
```

### Step 4: Compile mongoose with Bo's hacked tsan.
```
CC=/your/path/llvm-3.7.1.src/build/bin/clang CFLAGS="-g -O0 -fsanitize=thread" make linux
```

### Step 5: Run mongoose's default test cases.
```
TSAN_OPTIONS="log_path=/your/path/mongoose-3.6/error_log.log" CC=/your/path/llvm-3.7.1.src/build/bin/clang make tests
```
