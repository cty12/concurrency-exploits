------------------------------------------------------------
revno: 2858
committer: Gleb Shchepa <gshchepa@mysql.com>
branch nick: mysql-5.1
timestamp: Wed 2009-05-13 12:51:39 +0500
message:
  Bug #44290: explain crashes for subquery with distinct in
              SQL_SELECT::test_quick_select
  
  The crash was caused by an incomplete cleanup of JOIN_TAB::select
  during the filesort of rows for GROUP BY clause inside a subquery.
  Queries where a quick index access is replaced with filesort was
  was affected. For example:
  
    SELECT 1 FROM
      (SELECT COUNT(DISTINCT c1) FROM t1
         WHERE c2 IN (1, 1) AND c3 = 2 GROUP BY c2) x
  
  Quick index access related data in the SQL_SELECT::test_quick_select
  function was inconsistent after an incomplete cleanup.
  This function has been completed to prevent crashes in the
  SQL_SELECT::test_quick_select function.
------------------------------------------------------------
revno: 2857
committer: Joerg Bruehe <joerg@mysql.com>
branch nick: push-5.1
timestamp: Fri 2009-05-08 21:04:07 +0200
message:
  Merge main 5.1 into 5.1-build
  
  165 changesets with 23 conflicts:
  Text conflict in mysql-test/r/lock_multi.result
  Text conflict in mysql-test/t/lock_multi.test
  Text conflict in mysql-test/t/mysqldump.test
  Text conflict in sql/item_strfunc.cc
  Text conflict in sql/log.cc
  Text conflict in sql/log_event.cc
  Text conflict in sql/parse_file.cc
  Text conflict in sql/slave.cc
  Text conflict in sql/sp.cc
  Text conflict in sql/sp_head.cc
  Text conflict in sql/sql_acl.cc
  Text conflict in sql/sql_base.cc
  Text conflict in sql/sql_class.cc
  Text conflict in sql/sql_crypt.cc
  Text conflict in sql/sql_db.cc
  Text conflict in sql/sql_lex.cc
  Text conflict in sql/sql_parse.cc
  Text conflict in sql/sql_select.cc
  Text conflict in sql/sql_table.cc
  Text conflict in sql/sql_view.cc
  Text conflict in storage/innobase/handler/ha_innodb.cc
  Text conflict in storage/myisam/mi_packrec.c
  Text conflict in tests/mysql_client_test.c
  
  Updates to Innobase, taken from main 5.1:
  bzr: ERROR: Some change isn't sane:
  File mysql-test/r/innodb-semi-consistent.result is owned by Innobase and should not be updated.
  File mysql-test/t/innodb-semi-consistent.test is owned by Innobase and should not be updated.
  File storage/innobase/handler/ha_innodb.cc is owned by Innobase and should not be updated.
  File storage/innobase/ibuf/ibuf0ibuf.c is owned by Innobase and should not be updated.
  File storage/innobase/include/row0mysql.h is owned by Innobase and should not be updated.
  File storage/innobase/include/srv0srv.h is owned by Innobase and should not be updated.
  File storage/innobase/include/trx0trx.h is owned by Innobase and should not be updated.
  File storage/innobase/include/trx0trx.ic is owned by Innobase and should not be updated.
  File storage/innobase/lock/lock0lock.c is owned by Innobase and should not be updated.
  File storage/innobase/page/page0cur.c is owned by Innobase and should not be updated.
  File storage/innobase/row/row0mysql.c is owned by Innobase and should not be updated.
  File storage/innobase/row/row0sel.c is owned by Innobase and should not be updated.
  File storage/innobase/srv/srv0srv.c is owned by Innobase and should not be updated.
  File storage/innobase/trx/trx0trx.c is owned by Innobase and should not be updated.
  (Set env var 'ALLOW_UPDATE_INNOBASE_OWNED' to override.)
    ------------------------------------------------------------
    revno: 2828.9.3
    committer: Davi Arnaut <Davi.Arnaut@Sun.COM>
    branch nick: mysql-5.1
    timestamp: Tue 2009-05-05 21:02:06 +0200
    message:
      Merge from 5.1-pe-stage into 5.1 main.
        ------------------------------------------------------------
        revno: 2852.1.38
        committer: Davi Arnaut <Davi.Arnaut@Sun.COM>
        branch nick: mysql-5.1-pe-stage
        timestamp: Tue 2009-05-05 20:47:43 +0200
        message:
          Remove unused variable.
        ------------------------------------------------------------
        revno: 2852.1.37
        committer: Satya B <satya.bn@sun.com>
        branch nick: mysql-5.1-pe-stage-40827
        timestamp: Mon 2009-05-04 14:35:16 +0530
        message:
          Additional Fix for BUG#40827 - Killing insert-select to MyISAM can cause
                                         table corruption
          
          Disabling the mysiam_debug.test in embedded mode because of BUG#43733
        ------------------------------------------------------------
        revno: 2852.1.36
        committer: Georgi Kodinov <joro@sun.com>
        branch nick: merge-5.1-bugteam
        timestamp: Thu 2009-04-30 18:00:51 +0300
        message:
          merge
            ------------------------------------------------------------
            revno: 1810.3889.3
            committer: Andrei Elkin <aelkin@mysql.com>
            branch nick: 5.0-bt-bug38694-race_condition_at_shutdown
            timestamp: Thu 2009-04-30 17:32:46 +0300
            message:
              merging from 5.0-bt rep to a local branch
        ------------------------------------------------------------
        revno: 2852.1.35
        committer: Sergey Vojtovich <svoj@sun.com>
        branch nick: mysql-5.1-bugteam-push
        timestamp: Thu 2009-04-30 19:41:43 +0500
        message:
          Merge to 5.1-bugteam.
            ------------------------------------------------------------
            revno: 2852.25.1
            committer: Sergey Vojtovich <svoj@sun.com>
            branch nick: mysql-5.1-bugteam-bug42907
            timestamp: Thu 2009-04-23 16:24:08 +0500
            message:
              BUG#42907 - Multi-term boolean fulltext query containing a
                          single quote fails in 5.1.x
              
              Performing fulltext prefix search (a word with truncation
              operator) may cause a dead-loop.
              
              The problem was in smarter index merge algorithm - it was writing
              record reference to an incorrect memory area.
        ------------------------------------------------------------
        revno: 2852.1.34
        committer: Andrei Elkin <aelkin@mysql.com>
        branch nick: 5.1-bt
        timestamp: Thu 2009-04-30 17:29:57 +0300
        message:
          merge 5.1-bt rep -> local 5.1-bt
            ------------------------------------------------------------
            revno: 2852.24.3
            committer: Georgi Kodinov <joro@sun.com>
            branch nick: merge-5.1-bugteam
            timestamp: Thu 2009-04-30 16:44:13 +0300
            message:
              merged 5.0-bugteam -> 5.1-bugteam
                ------------------------------------------------------------
                revno: 1810.3885.12
                committer: Georgi Kodinov <joro@sun.com>
                branch nick: merge-5.0-bugteam
                timestamp: Thu 2009-04-30 16:39:00 +0300
                message:
                  merged 5.0-main to 5.0-bugteam
                ------------------------------------------------------------
                revno: 1810.3875.7
                committer: Georgi Kodinov <joro@sun.com>
                branch nick: mysql-5.0
                timestamp: Thu 2009-04-16 16:47:02 +0300
                message:
                  bumped the version to 5.0.82 (5.0.81-community to be released)
            ------------------------------------------------------------
            revno: 2852.24.2
            committer: Georgi Kodinov <joro@sun.com>
            branch nick: merge-5.1-bugteam
            timestamp: Thu 2009-04-30 16:42:38 +0300
            message:
              merged 5.1-main to 5.1-bugteam
            ------------------------------------------------------------
            revno: 2852.24.1
            committer: Narayanan V <v.narayanan@sun.com>
            branch nick: mysql-5.1-bugteam-37631-7
            timestamp: Thu 2009-04-30 18:22:48 +0530
            message:
              merging with mysql-5.1-bugteam
            ------------------------------------------------------------
            revno: 2852.23.1
            committer: Narayanan V <v.narayanan@sun.com>
            branch nick: mysql-5.1-bugteam-37631-6
            timestamp: Thu 2009-04-30 18:16:49 +0530
            message:
              BUG#37631 - Incorrect key file for table after upgrading from 5.0 to 5.1
              
              This patch adds corrections to the original patch
              submitted 2009-04-08 (http://lists.mysql.com/commits/71607):
              
              - fixed that the original patch didn't work because of an
                incorrect condition;
              - added a test case.
        ------------------------------------------------------------
        revno: 2852.1.33
        committer: Andrei Elkin <aelkin@mysql.com>
        branch nick: 5.1-bt
        timestamp: Thu 2009-04-30 16:20:38 +0300
        message:
          moving bug#38694 test files into rpl suite
        ------------------------------------------------------------
        revno: 2852.1.32
        committer: Andrei Elkin <aelkin@mysql.com>
        branch nick: 5.1-bt
        timestamp: Thu 2009-04-30 16:17:46 +0300
        message:
          merging 5.0-bt to 5.1-bt
            ------------------------------------------------------------
            revno: 1810.3889.2
            committer: Andrei Elkin <aelkin@mysql.com>
            branch nick: 5.0-bt-bug38694-race_condition_at_shutdown
            timestamp: Thu 2009-04-30 15:41:47 +0300
            message:
              merging from 5.0-bt rep to a local branch
            ------------------------------------------------------------
            revno: 1810.3889.1
            committer: Andrei Elkin <aelkin@mysql.com>
            branch nick: 5.0-bt-bug38694-race_condition_at_shutdown
            timestamp: Tue 2009-04-28 14:46:07 +0300
            message:
              Bug #38694  Race condition in replication thread shutdown 
              
              The issue of the current bug is unguarded access to mi->slave_running 
              by the shutdown thread calling end_slave() that is bug#29968 
              (alas happened not to be cross-linked with the current bug)
              
              Fixed:
              
              with removing the unguarded read of the running status
              and perform reading it in terminate_slave_thread()
              at time run_lock is taken (mostly bug#29968 backporting, still with some
              improvements over that patch - see the error reporting from 
              terminate_slave_thread()).
              Issue of bug#38716 is fixed here for 5.0 branch as well.
              
              Note:
              
              There has been a separate artifact identified - 
              a race condition between init_slave() and  end_slave() - 
              reported as  Bug#44467.
        ------------------------------------------------------------
        revno: 2852.1.31
        committer: Andrei Elkin <aelkin@mysql.com>
        branch nick: 5.1-bt
        timestamp: Thu 2009-04-30 15:47:09 +0300
        message:
          merge bug#44179 fixes to 5.1-bt
            ------------------------------------------------------------
            revno: 2852.16.5
            committer: Andrei Elkin <aelkin@mysql.com>
            branch nick: 5.1-bt-bug44179-child_of_41902-reset_logs_error_assert
            timestamp: Thu 2009-04-30 15:28:07 +0300
            message:
              Bug #44179 reset slave crashes in my_error when reset_logs returns non-zero
              
              my_error() was invoked in reset_slave()'s with purge_relay_logs()-failing branch
              without passing sql_errno to it.
              
              Fixed with setting sql_errno= ER_RELAY_LOG_FAIL in the purge_relay_logs()-failing branch.
        ------------------------------------------------------------
        revno: 2852.1.30
        committer: Sergey Glukhov <Sergey.Glukhov@sun.com>
        branch nick: mysql-5.1-bugteam
        timestamp: Thu 2009-04-30 15:17:56 +0500
        message:
          automerge
            ------------------------------------------------------------
            revno: 2852.21.2
            committer: Satya B <satya.bn@sun.com>
            branch nick: mysql-5.1-bugteam-40827
            timestamp: Thu 2009-04-30 16:44:50 +0530
            message:
              merget to 5.1-bugteam
                ------------------------------------------------------------
                revno: 2852.22.1
                committer: Matthias Leich <Matthias.Leich@sun.com>
                branch nick: mysql-5.1-bugteam-43546-push
                timestamp: Thu 2009-04-30 12:29:19 +0200
                message:
                  Merge 5.0 -> 5.1 of fix for Bug 44522
                  This is a "null" merge because the fix is
                  already in 5.1
                ------------------------------------------------------------
                revno: 1810.3885.11
                committer: Matthias Leich <Matthias.Leich@sun.com>
                branch nick: mysql-5.0-bugteam-43546-push
                timestamp: Thu 2009-04-30 12:26:11 +0200
                message:
                  Merge of fix for Bug#44522 main.not_embedded_server fails with "--check-testcases"
                  into actual tree
            ------------------------------------------------------------
            revno: 2852.21.1
            committer: Satya B <satya.bn@sun.com>
            branch nick: mysql-5.1-bugteam-40827
            timestamp: Thu 2009-04-30 16:33:44 +0530
            message:
              Addition to the fix for BUG#40827 - Killing insert-select to MyISAM can cause
                                                  table corruption
              
              
              Moved the testcase from the file myisam.test to the new testfile 
              mysiam_debug.test
               
        ------------------------------------------------------------
        revno: 2852.1.29
        committer: Sergey Glukhov <Sergey.Glukhov@sun.com>
        branch nick: mysql-5.1-bugteam
        timestamp: Thu 2009-04-30 14:37:29 +0500
        message:
          Bug#43962 "Packets out of order" calling a SHOW TABLE STATUS
          Error happens because sp_head::MULTI_RESULTS is not set for SP
          which has 'show table status' command.
          The fix is to add a SQLCOM_SHOW_TABLE_STATUS case into
          sp_get_flags_for_command() func.
        ------------------------------------------------------------
        revno: 2852.1.28
        committer: Alexey Botchkov <holyfoot@mysql.com>
        branch nick: 51mrg
        timestamp: Thu 2009-04-30 12:54:45 +0500
        message:
          merging
            ------------------------------------------------------------
            revno: 1810.3885.10
            committer: Alexey Botchkov <holyfoot@mysql.com>
            branch nick: mysql-5.0-test
            timestamp: Thu 2009-04-30 12:52:27 +0500
            message:
              mysql_client_test fixed.
              
              per-file comments:
                tests/mysql_client_test.c
              the test for bug 37956 isn't relevant anymore.
              The query there 'select point(?,?)' doesn't produce an error.
        ------------------------------------------------------------
        revno: 2852.1.27
        committer: Satya B <satya.bn@sun.com>
        branch nick: mysql-5.1-bugteam-40827
        timestamp: Thu 2009-04-30 12:40:12 +0530
        message:
          Fix for BUG#40827 - Killing insert-select to MyISAM can cause table corruption
                                 
          Killing the insert-select statement corrupts the MyISAM table only
          when the destination table is empty and when it has indexes. When 
          we bulk insert huge data and if the destination table is empty we 
          disable the indexes for fast inserts, data is then inserted and 
          indexes are re-enabled after bulk_insert operation
                                  
          Killing the query, aborts the repair table operation during enable
          indexes phase leading to table corruption.
                                
          We now truncate the table when we detect that enable indexes is
          killed for bulk insert query.As we have an empty table before the 
          operation, we can fix by truncating the table.
            ------------------------------------------------------------
            revno: 2852.20.1
            committer: Satya B <satya.bn@sun.com>
            branch nick: mysql-5.1-bugteam-40827-push
            timestamp: Thu 2009-04-16 17:02:56 +0530
            message:
              BUG#40827 - Killing insert-select to MyISAM can cause table corruption
                                
              Killing insert-select statement on MyISAM corrupts the table.
                                
              Killing the insert-select statement corrupts the MyISAM table only
              when the destination table is empty and when it has indexes. When 
              we bulk insert huge data and if the destination table is empty we 
              disable the indexes for fast inserts, data is then inserted and 
              indexes are re-enabled after bulk_insert operation
                                
              Killing the query, aborts the repair table operation during enable
              indexes phase leading to table corruption.
                              
              We now truncate the table when we detect that enable indexes is
              killed for bulk insert query.As we have an empty table before the 
              operation, we can fix by truncating the table.
        ------------------------------------------------------------
        revno: 2852.1.26
        committer: Martin Hansson <mhansson@mysql.com>
        branch nick: 5.1bt-non-gca
        timestamp: Wed 2009-04-29 20:52:37 +0200
        message:
          merge
            ------------------------------------------------------------
            revno: 2852.17.3
            committer: Vladislav Vaintroub <vvaintroub@mysql.com>
            branch nick: mysql-5.1-bugteam
            timestamp: Wed 2009-04-29 14:29:54 +0200
            message:
              merge
                ------------------------------------------------------------
                revno: 2852.19.1
                committer: Narayanan V <v.narayanan@sun.com>
                branch nick: mysql-5.1-bugteam-44337
                timestamp: Wed 2009-04-29 16:51:14 +0530
                message:
                  Bug#44337 Select query using index merge fails with MCH3601
                  
                  The storage engine was not correctly handling the case in 
                  which rnd_pos is executed for a handler without a preceding
                  rnd_next or index read operation. As a result, an unitialized
                  file handle was sometimes being passed to the QMY_READ API.
                  
                  The fix clears the rrnAssocHandle at the beginning of each
                  read operation and then checks to see whether it has been
                  set to a valid handle value before attempting to use it
                  in rnd_pos. If rrnAssocHandle has not been set by a previous
                  read operation, rnd_pos instead falls back to the use of the
                  currently active handle.
            ------------------------------------------------------------
            revno: 2852.17.2
            committer: Vladislav Vaintroub <vvaintroub@mysql.com>
            branch nick: mysql-5.1-bugteam
            timestamp: Wed 2009-04-29 13:51:10 +0200
            message:
              Bug#43932 myisam index corruption with large index and large 
              key_buffer_size.
              
              The cause of corruption was number overflow when multiplying 
              two ulong values, number of used keycache blocks with size
              of a single block. The result of multiplication exceeded ulong 
              range (4G) and this lead to incorrectly calculated  buffer offset
              in the key cache.
              
              The fix is to use size_t for multiplication result.
              
              This patch also fixes pointless cast in safemalloc 
              (size of allocated block to uint), that creates lot of false
              alarm warnings when using big keycache (> 4GB) in debug mode.
        ------------------------------------------------------------
        revno: 2852.1.25
        committer: Martin Hansson <mhansson@mysql.com>
        branch nick: 5.1bt
        timestamp: Wed 2009-04-29 14:00:34 +0200
        message:
          Bug#43737: Select query return bad result
                
          A bug in the initialization of key segment information made it point
          to the wrong bit, since a bit index was used when its int value
          was needed. This lead to misinterpretation of bit columns
          read from MyISAM record format when a NULL bit pushed them over
          a byte boundary.
          Fixed by using the int value of the bit instead.
        ------------------------------------------------------------
        revno: 2852.1.24
        committer: Alexey Botchkov <holyfoot@mysql.com>
        branch nick: 51mrg
        timestamp: Wed 2009-04-29 09:41:36 +0500
        message:
          merging
            ------------------------------------------------------------
            revno: 1810.3885.9
            committer: Alexey Botchkov <holyfoot@mysql.com>
            branch nick: 50mrg
            timestamp: Wed 2009-04-29 09:40:50 +0500
            message:
              merging
        ------------------------------------------------------------
        revno: 2852.1.23
        committer: Alexey Botchkov <holyfoot@mysql.com>
        branch nick: 51mrg
        timestamp: Wed 2009-04-29 09:39:49 +0500
        message:
          merging
            ------------------------------------------------------------
            revno: 2852.16.4
            committer: Alfranio Correia <alfranio.correia@sun.com>
            branch nick: mysql-5.1-bugteam-push
            timestamp: Tue 2009-04-28 23:10:29 +0100
            message:
              merge 5.1-bugteam (local) --> 5.1-bugteam
                ------------------------------------------------------------
                revno: 2852.18.2
                committer: Alfranio Correia <alfranio.correia@sun.com>
                branch nick: mysql-5.1-bugteam
                timestamp: Sun 2009-04-26 22:21:01 +0100
                message:
                  Fixed rpl_innodb_mixed_ddl and rpl_000015.
                  
                  Respectively, replaced "--exec diff" by "--diff_files" which is a mysqltest command to run a
                  non-operating system specific diff. Removed the file rpl_000015-slave.sh as it is not
                  necessary in the new MTR.
                ------------------------------------------------------------
                revno: 2852.18.1
                committer: Alfranio Correia <alfranio.correia@sun.com>
                branch nick: mysql-5.1-bugteam
                timestamp: Fri 2009-04-24 02:02:07 +0100
                message:
                  BUG#44389 rpl_row_mysqlbinlog fails on windows due to operating system
                            specifc command
                  
                  Replaced "--exec rm" by "remove_file" which is a mysqltest command to
                  erase a file.
            ------------------------------------------------------------
            revno: 2852.16.3
            committer: Matthias Leich <Matthias.Leich@sun.com>
            branch nick: mysql-5.1-bugteam-43546-push
            timestamp: Tue 2009-04-28 21:50:55 +0200
            message:
              Automatic merge, no conflicts, no changes
                ------------------------------------------------------------
                revno: 1810.3887.2
                committer: Matthias Leich <Matthias.Leich@sun.com>
                branch nick: mysql-5.0-bugteam-43546-push
                timestamp: Tue 2009-04-28 21:48:10 +0200
                message:
                  Merge latest changes into local GCA tree
                  no conflicts
            ------------------------------------------------------------
            revno: 2852.16.2
            committer: Matthias Leich <Matthias.Leich@sun.com>
            branch nick: mysql-5.1-bugteam-43546-push
            timestamp: Tue 2009-04-28 21:33:18 +0200
            message:
              Merge of latest changes into local GCA tree
              no conflicts
                ------------------------------------------------------------
                revno: 2852.17.1
                committer: Staale Smedseng <staale.smedseng@sun.com>
                branch nick: 35769-51g
                timestamp: Tue 2009-04-28 18:19:55 +0200
                message:
                  Merge from 5.0-bugteam
                ------------------------------------------------------------
                revno: 1810.3888.1
                committer: Staale Smedseng <staale.smedseng@sun.com>
                branch nick: 35769-50g
                timestamp: Tue 2009-04-28 18:16:17 +0200
                message:
                  Bug#35769 typo in mysqlhotcopy documentation
                        
                  Fixed a number of typos, and made punctuation and
                  capitalization more consistent in documentation
                  and help.
            ------------------------------------------------------------
            revno: 2852.16.1
            committer: Matthias Leich <Matthias.Leich@sun.com>
            branch nick: mysql-5.1-bugteam-43546x
            timestamp: Tue 2009-04-28 20:42:17 +0200
            message:
              Merge 5.0 -> 5.1 of fix for Bug 43546
                    Several 5.0 tests do not pass MTR's --check option (moved from Bug 42308)
            ------------------------------------------------------------
            revno: 1810.3887.1
            committer: Matthias Leich <Matthias.Leich@sun.com>
            branch nick: mysql-5.0-bugteam-43546x
            timestamp: Tue 2009-04-28 20:12:18 +0200
            message:
              Fix for Bug#43546 Several 5.0 tests do not pass MTR's --check option
                                (moved from Bug 42308)
              
              Details:
              - insert_update
                Add DROP TABLE which was missing, error numbers -> names
              - varbinary
                Add DROP TABLE which was missing
              - sp_trans_log
                Add missing DROP function, improved formatting
        ------------------------------------------------------------
        revno: 2852.1.22
        committer: Alexey Botchkov <holyfoot@mysql.com>
        branch nick: 51mrg
        timestamp: Wed 2009-04-29 07:59:10 +0500
        message:
          merging
            ------------------------------------------------------------
            revno: 1810.3885.8
            committer: Alexey Botchkov <holyfoot@mysql.com>
            branch nick: 50mrg
            timestamp: Tue 2009-04-28 14:48:54 +0500
            message:
              merging
                ------------------------------------------------------------
                revno: 1810.3886.1
                committer: Alexey Botchkov <holyfoot@mysql.com>
                branch nick: 25058
                timestamp: Fri 2008-11-21 17:38:42 +0400
                message:
                  Bug#25058 ignored return codes in memory allocation functions
                     memory allocation error checks added for functions
                     calling insert_dynamic()
                  
                  per-file messages:
                    myisam/mi_delete.c
                  Bug#25058 ignored return codes in memory allocation functions
                      out-of-memory errors handled
                    myisam/mi_write.c
                  Bug#25058 ignored return codes in memory allocation functions
                      out-of-memory errors handled
                    server-tools/instance-manager/instance_options.cc
                  Bug#25058 ignored return codes in memory allocation functions
                      out-of-memory errors handled
                    sql/slave.cc
                  Bug#25058 ignored return codes in memory allocation functions
                      out-of-memory errors handled
                    sql/sp_head.cc
                  Bug#25058 ignored return codes in memory allocation functions
                      out-of-memory errors handled
                    sql/sp_head.h
                  Bug#25058 ignored return codes in memory allocation functions
                      out-of-memory errors handled
                    sql/sp_pcontext.cc
                  Bug#25058 ignored return codes in memory allocation functions
                      out-of-memory errors handled
                    sql/sp_pcontext.h
                  Bug#25058 ignored return codes in memory allocation functions
                      out-of-memory errors handled
                    sql/sql_select.cc
                  Bug#25058 ignored return codes in memory allocation functions
                      out-of-memory errors handled
                    sql/sql_yacc.yy
                  Bug#25058 ignored return codes in memory allocation functions
                      out-of-memory errors handled
            ------------------------------------------------------------
            revno: 1810.3885.7
            committer: Alexey Botchkov <holyfoot@mysql.com>
            branch nick: 50mrg
            timestamp: Tue 2009-04-28 14:47:26 +0500
            message:
              Bug#38990 Arbitrary data input plus GIS functions causes mysql server crash 
                 the Point() and Linestring() functions create WKB representation of an
                 object instead of an real geometry object.
                 That produced bugs when these were inserted into tables.
              
                 GIS tests fixed accordingly.
                          
              per-file messages:
                mysql-test/r/gis-rtree.result
              Bug#38990 Arbitrary data input plus GIS functions causes mysql server crash 
                  test result
                mysql-test/r/gis.result
              Bug#38990 Arbitrary data input plus GIS functions causes mysql server crash 
                  test result
                mysql-test/t/gis-rtree.test
              Bug#38990 Arbitrary data input plus GIS functions causes mysql server crash 
                  test fixed - GeomFromWKB invocations removed
                mysql-test/t/gis.test
              Bug#38990 Arbitrary data input plus GIS functions causes mysql server crash 
                  test fixed - AsWKB invocations added
                sql/item_geofunc.cc
              Bug#38990 Arbitrary data input plus GIS functions causes mysql server crash 
                   Point() and similar functions to create a proper object
        ------------------------------------------------------------
        revno: 2852.1.21
        committer: Gleb Shchepa <gshchepa@mysql.com>
        branch nick: mysql-5.1-bugteam
        timestamp: Tue 2009-04-28 05:27:38 +0500
        message:
          manual merge 5.0-bugteam --> 5.1-bugteam
            ------------------------------------------------------------
            revno: 1810.3885.6
            committer: Gleb Shchepa <gshchepa@mysql.com>
            branch nick: mysql-5.0-bugteam
            timestamp: Tue 2009-04-28 05:19:13 +0500
            message:
              backport from 6.0:
              
              Bug #40925: Equality propagation takes non indexed attribute
              
              Query execution plans and execution time of queries like
              
                select a, b, c from t1
                  where a > '2008-11-21' and b = a limit 10
              
              depended on the order of equality operator parameters:
              "b = a" and "a = b" are not same. 
              
              
              An equality propagation algorithm has been fixed:
              the substitute_for_best_equal_field function should not
              substitute a field for an equal field if both fields belong
              to the same table.
        ------------------------------------------------------------
        revno: 2852.1.20
        committer: Sergey Glukhov <Sergey.Glukhov@sun.com>
        branch nick: mysql-5.1-bugteam
        timestamp: Mon 2009-04-27 15:05:01 +0500
        message:
          ENCRYPT function always returns NULL on windows.
          The fix is to disable result log as we need to
          test valgrind error only.
        ------------------------------------------------------------
        revno: 2852.1.19
        committer: Patrick Crews <patrick.crews@sun.com>
        branch nick: mysql-5.1-bugteam
        timestamp: Fri 2009-04-24 13:00:17 -0400
        message:
          merge 5.0-> 5.1
            ------------------------------------------------------------
            revno: 1810.3885.5
            committer: Patrick Crews <patrick.crews@sun.com>
            branch nick: mysql-5.0-new
            timestamp: Fri 2009-04-24 12:58:23 -0400
            message:
              Bug#32784: Timeout in test "innodb_charset": InnoDB much slower than other handlers
              
              Turned off autocommit at the start of this test per Innobase recommendation.
              Noted significant reduction in run time for this test w/ a minor increase in other tests' run-times.
        ------------------------------------------------------------
        revno: 2852.1.18
        committer: Satya B <satya.bn@sun.com>
        branch nick: mysql-5.1-bugteam-innodb
        timestamp: Fri 2009-04-24 17:42:51 +0530
        message:
          NULL MERGE of innodb-5.0-ss4900 into 5.1 branch. Note BUG#42279 
          is pushed along with BUG#43309.
          
          Forgot to add BUG#4229 in the first paragraph in the commit 
          message
            ------------------------------------------------------------
            revno: 1810.3885.4
            committer: Satya B <satya.bn@sun.com>
            branch nick: mysql-5.0-bugteam-innodb
            timestamp: Fri 2009-04-24 17:27:53 +0530
            message:
              Applying InnoDB snashot 5.0-ss4900, part 2. Fixes BUG#43309
              
              1) BUG#43309 - Test main.innodb can't be run twice
              
              Detailed revision comments:
              
              r4701 | vasil | 2009-04-13 17:03:46 +0300 (Mon, 13 Apr 2009) | 6 lines
              branches/5.0:
              
              Fix Bug#43309 Test main.innodb can't be run twice
              
              by making the innodb.test reentrant.
            ------------------------------------------------------------
            revno: 1810.3885.3
            committer: Satya B <satya.bn@sun.com>
            branch nick: mysql-5.0-bugteam-innodb
            timestamp: Fri 2009-04-24 17:18:20 +0530
            message:
              Applying InnoDB snashot 5.0-ss4900 part 1, Fixes BUG#42279
              
              1) BUG#42279 - Race condition in btr_search_drop_page_hash_when_freed()
              
              Detailed revision comments:
              
              r4031 | marko | 2009-01-23 15:33:46 +0200 (Fri, 23 Jan 2009) | 8 lines
              branches/5.0: btr_search_drop_page_hash_when_freed(): Check if
              buf_page_get_gen() returns NULL.  The page may have been evicted
              from the buffer pool between buf_page_peek_if_search_hashed() and
              buf_page_get_gen(), because the buffer pool mutex will be released
              between these two calls. (Bug #42279)
              
              rb://82 approved by Heikki Tuuri
        ------------------------------------------------------------
        revno: 2852.1.17
        committer: Satya B <satya.bn@sun.com>
        branch nick: mysql-5.1-bugteam-innodb
        timestamp: Fri 2009-04-24 16:58:46 +0530
        message:
          
          NULL merge fix for BUG#43660 into 5.1 as the fix for this bug
          is already applied in 5.1
            ------------------------------------------------------------
            revno: 1810.3885.2
            committer: Satya B <satya.bn@sun.com>
            branch nick: mysql-5.0-bugteam-innodb
            timestamp: Fri 2009-04-24 16:53:56 +0530
            message:
              merge to latest 5.0-bugteam tree
            ------------------------------------------------------------
            revno: 1810.3885.1
            committer: Satya B <satya.bn@sun.com>
            branch nick: mysql-5.0-bugteam-innodb
            timestamp: Fri 2009-04-24 16:33:50 +0530
            message:
              Fix for BUG#43660- SHOW INDEXES/ANALYZE does NOT update cardinality 
                                 for indexes of InnoDB table
              
              Fixes by replacing the PRNG that is used to pick random pages with a 
              better one. 
              
              Also adds a configuration option "innodb_use_legacy_cardinality_algorithm"
              to enable the fix only when the option is set.
              
              This patch is from http://bugs.mysql.com/file.php?id=11789
        ------------------------------------------------------------
        revno: 2852.1.16
        committer: Anurag Shekhar <anurag.shekhar@sun.com>
        branch nick: mysql-5.1-bugteam
        timestamp: Fri 2009-04-24 14:49:07 +0530
        message:
          Bug #44353 build-v9.bat is missing in source archive
          
          Entry for build-vs9.bat and build-vs9_x64.bat was missing in
          win/Makefile.am. Added the entries to fix the problem.
        ------------------------------------------------------------
        revno: 2852.1.15
        committer: Staale Smedseng <staale.smedseng@sun.com>
        branch nick: b33146-51g
        timestamp: Thu 2009-04-23 19:55:32 +0200
        message:
          Merge from 5.0-bugteam
            ------------------------------------------------------------
            revno: 1810.3883.15
            committer: Staale Smedseng <staale.smedseng@sun.com>
            branch nick: b33146-50g
            timestamp: Thu 2009-04-23 19:52:39 +0200
            message:
              Bug#33146 CHECKSUM TABLE is not interruptable by KILL 
              QUERY statement
                    
              Commit 55629 applied to 5.0-bugteam and 5.1-bugteam: 
              Check for thd->killed in CHECKSUM loop.
        ------------------------------------------------------------
        revno: 2852.1.14
        committer: Sergey Glukhov <Sergey.Glukhov@sun.com>
        branch nick: mysql-5.1-bugteam
        timestamp: Thu 2009-04-23 12:50:34 +0500
        message:
          Bug#44367 valgrind warnings with find_in_set() functions
          init 'wc' variable
        ------------------------------------------------------------
        revno: 2852.1.13
        committer: Sergey Glukhov <Sergey.Glukhov@sun.com>
        branch nick: mysql-5.1-bugteam
        timestamp: Thu 2009-04-23 12:47:54 +0500
        message:
          Bug#44365 valgrind warnings with encrypt() function
          replaced String->c_ptr() with String->c_ptr_safe()
        ------------------------------------------------------------
        revno: 2852.1.12
        committer: Sergey Glukhov <Sergey.Glukhov@sun.com>
        branch nick: mysql-5.1-bugteam
        timestamp: Thu 2009-04-23 12:43:42 +0500
        message:
          Bug#44358 valgrind errors with decode() function
          The warning happens because string argument is not zero ended.
          The fix is to add new parameter 'length' to SQL_CRYPT() and
          use ptr() instead of c_ptr().
        ------------------------------------------------------------
        revno: 2852.1.11
        committer: Alfranio Correia <alfranio.correia@sun.com>
        branch nick: mysql-5.1-bugteam-push
        timestamp: Tue 2009-04-21 15:31:21 +0100
        message:
          BUG#44378 rpl_binlog_corruption fails with warning messages in Valgrind
                
          The rpl_binlog_corruption test case was inject failures, specifically,
          incidents with invalid numbers to see if the replication was failing
          gracefully. However, this test was causing the following warning message
          in Valgrind: "Conditional jump or move depends on uninitialised value(s)"
                
          The patch fixes the problem by correctly initializing the m_inicident 
          number.
        ------------------------------------------------------------
        revno: 2852.1.10
        committer: Sergey Vojtovich <svoj@sun.com>
        branch nick: mysql-5.1-bugteam-bug36966
        timestamp: Tue 2009-04-21 15:25:04 +0500
        message:
          Merge 5.0-bugteam to 5.1-bugteam.
            ------------------------------------------------------------
            revno: 1810.3883.14
            committer: Sergey Vojtovich <svoj@sun.com>
            branch nick: mysql-5.0-bugteam-bug36966
            timestamp: Tue 2009-04-21 14:01:13 +0500
            message:
              BUG#36966 - mysqldump.test fails in pushbuild
              
              mysqldump.test is designed to run with concurrent inserts
              disabled. It is disabling concurrent inserts at the very
              beginning of the test case, and re-enables them at the
              bottom of the test. But for some reason (likely incorrect
              merge) we enable concurrent inserts in the middle of the test.
              
              The problem is fixed by enabling concurrent inserts only
              at the bottom of the test case.
        ------------------------------------------------------------
        revno: 2852.1.9
        committer: Andrei Elkin <aelkin@mysql.com>
        branch nick: mysql-5.1-bugteam
        timestamp: Tue 2009-04-21 11:30:40 +0300
        message:
          merge bug#38205 fixes to 5.1-bt
            ------------------------------------------------------------
            revno: 2806.46.2
            committer: Andrei Elkin <aelkin@mysql.com>
            branch nick: 5.1-bt-bug38205-stop_slave_trans
            timestamp: Thu 2009-04-09 16:05:41 +0300
            message:
              Bug #38205 Row-based Replication (RBR) causes inconsistencies: HA_ERR_FOUND_DUPP_KEY
              Bug#319  if while a non-transactional slave is replicating a transaction possible problem
              
              only testing related: addressing reviewers' comments.
            ------------------------------------------------------------
            revno: 2806.46.1
            committer: Andrei Elkin <aelkin@mysql.com>
            branch nick: 5.1-bt-bug38205-stop_slave_trans
            timestamp: Thu 2009-03-26 10:25:06 +0200
            message:
              Bug#38205 Row-based Replication (RBR) causes inconsistencies: HA_ERR_FOUND_DUP
              Bug#319  if while a non-transactional slave is replicating a transaction possible problem 
              
              It is impossible to roll back a mixed engines transaction when one of the engine is
              non-transaction. In replication that fact is crucial because the slave can not safely
              re-apply a transction that was interrupted with STOP SLAVE.
              
              Fixed with making STOP SLAVE not be effective immediately in the case the current
              group of replication events has modified a non-transaction table. In order for slave to leave
              either the group needs finishing or the user issues KILL QUERY|CONNECTION slave_thread_id.
        ------------------------------------------------------------
        revno: 2852.1.8
        committer: Satya B <satya.bn@sun.com>
        branch nick: mysql-5.1-bugteam-innodb
        timestamp: Mon 2009-04-20 12:57:41 +0530
        message:
          Applying InnoDB snashot 5.1-ss3603. Fixes BUG#27276
          
          1) BUG#27276 - InnoDB Error: ibuf cursor restoration fails
          
          2) Follow up fix for BUG#27276 which fixes the bug introduced in
             the previous revision r2924
          
          Detailed revision comments:
          
          r2924 | marko | 2008-10-29 10:07:48 +0200 (Wed, 29 Oct 2008) | 7 lines
          branches/5.1: Merge revision 2866 from branches/zip:
          
          ibuf_delete_rec(): When the cursor to the insert buffer record cannot be
          restored, do not complain if the tablespace does not exist. (Bug #27276)
          
          Approved by Sunny Bains (rb://34)
          
          r3598 | marko | 2008-12-22 15:28:03 +0200 (Mon, 22 Dec 2008) | 6 lines
          branches/5.1: ibuf_delete_rec(): When the record cannot be found and
          the tablespace has been dropped, commit the mini-transaction, so that
          InnoDB will not hold the insert buffer tree latch in exclusive mode,
          causing a potential deadlock.  This bug was introduced in the fix of
          Bug #27276 in r2924.
        ------------------------------------------------------------
        revno: 2852.1.7
        committer: Chad MILLER <chad@mysql.com>
        branch nick: 5.1-bugteam
        timestamp: Fri 2009-04-17 16:40:01 -0400
        message:
          Merge bugteam trunk and local.
            ------------------------------------------------------------
            revno: 2852.13.9
            committer: Georgi Kodinov <joro@sun.com>
            branch nick: B35087-5.1-bugteam
            timestamp: Fri 2009-04-17 19:18:00 +0300
            message:
              merged bug 35087 to 5.1-bugteam
                ------------------------------------------------------------
                revno: 1810.3883.13
                committer: Georgi Kodinov <joro@sun.com>
                branch nick: B35087-5.0-bugteam
                timestamp: Fri 2009-04-17 18:52:57 +0300
                message:
                  Bug #35087: Inserting duplicate values at one time with DES_ENCRYPT leads 
                    to wrong results
                        
                  3 problems found with DES_ENCRYPT/DES_DECRYPT :
                  
                  1. The max length was not calculated properly. Fixed in fix_length_and_dec()
                  2. DES_ENCRYPT had a side effect of sometimes reallocating and changing 
                  the value of its argument. Fixed by explicitly pre-allocating the necessary
                  space to pad the argument with trailing '*' (stars) when calculating the 
                  DES digest.
                  3. in DES_ENCRYPT the string buffer for the result value was not 
                  reallocated to the correct size and only string length was assigned to it. 
                  Fixed by making sure there's enough space to hold the result.
            ------------------------------------------------------------
            revno: 2852.13.8
            committer: Sergey Glukhov <Sergey.Glukhov@sun.com>
            branch nick: mysql-5.1-bugteam
            timestamp: Fri 2009-04-17 13:46:27 +0500
            message:
              5.0-bugteam->5.1-bugteam merge
                ------------------------------------------------------------
                revno: 1810.3883.12
                committer: Sergey Glukhov <Sergey.Glukhov@sun.com>
                branch nick: mysql-5.0-bugteam
                timestamp: Fri 2009-04-17 12:41:15 +0500
                message:
                  Bug#44151 using handler commands on information_schema tables crashes server
                  information schema tables are based on internal tmp tables which are removed
                  after each statement execution. So HANDLER comands can not be used with
                  information schema.
            ------------------------------------------------------------
            revno: 2852.13.7
            committer: Anurag Shekhar <anurag.shekhar@sun.com>
            branch nick: mysql-5.1-bugteam
            timestamp: Fri 2009-04-17 11:23:54 +0530
            message:
              merging with local bugfix branch.
                ------------------------------------------------------------
                revno: 2852.15.1
                committer: Anurag Shekhar <anurag.shekhar@sun.com>
                branch nick: mysql-5.1-44040
                timestamp: Fri 2009-04-17 11:21:51 +0530
                message:
                  Bug#44040 MySQL allows creating a MERGE table upon VIEWs but crashes when 
                          using it.
                  The crash was due to a null pointer present for select_lex while 
                  processing the view.
                  Adding a check while opening the view to see if its a child of a 
                  merge table fixed this problem.
            ------------------------------------------------------------
            revno: 2852.13.6
            committer: Patrick Crews <patrick.crews@sun.com>
            branch nick: mysql-5.1-bugteam
            timestamp: Thu 2009-04-16 13:50:38 -0400
            message:
              merge 5.0-> 5.1
                ------------------------------------------------------------
                revno: 1810.3883.11
                committer: Patrick Crews <patrick.crews@sun.com>
                branch nick: mysql-5.0-bugteam
                timestamp: Thu 2009-04-16 13:47:44 -0400
                message:
                  Bug#26887 - main.count_distinct3 fails randomly
                  
                  Streamlined how we increase the size of our test table.
                  The new method shows run time decreased by ~60%.
                  This is not a guarantee that we will not see test timeouts (the random failures noted in the bug),
                  but it should significantly reduce the chances of this occurring.
            ------------------------------------------------------------
            revno: 2852.13.5
            committer: Staale Smedseng <staale.smedseng@sun.com>
            branch nick: b42430-51g
            timestamp: Thu 2009-04-16 11:47:21 +0200
            message:
              Merge from 5.0-bugteam
                ------------------------------------------------------------
                revno: 1810.3883.10
                committer: Staale Smedseng <staale.smedseng@sun.com>
                branch nick: b42430-50g
                timestamp: Thu 2009-04-16 11:40:51 +0200
                message:
                  Bug#42430 Final commit to 5.0-bugteam
            ------------------------------------------------------------
            revno: 2852.13.4
            committer: Alfranio Correia <alfranio.correia@sun.com>
            branch nick: mysql-5.1-bugteam-push
            timestamp: Wed 2009-04-15 17:06:48 +0100
            message:
              auto-merge 5.1-bugteam --> 5.1-bugteam (local)
                ------------------------------------------------------------
                revno: 2852.14.1
                committer: Alfranio Correia <alfranio.correia@sun.com>
                branch nick: mysql-5.1-bugteam
                timestamp: Wed 2009-04-15 12:43:17 +0100
                message:
                  BUG#41793 rpl_binlog_corruption disabled in main (needs new mtr)
                  
                  The test case was missing "let $slave_sql_errno= 1594;".
            ------------------------------------------------------------
            revno: 2852.13.3
            committer: Satya B <satya.bn@sun.com>
            branch nick: mysql-5.1-bugteam-innodb
            timestamp: Wed 2009-04-15 18:11:54 +0530
            message:
              Applying InnoDB snashot 5.1-ss4699, part 3. Fixes BUG#43660
              
              1) BUG#43660 - SHOW INDEXES/ANALYZE does NOT update cardinality 
                             for indexes of InnoDB table
              
              Detailed revision comments:
              
              r4699 | vasil | 2009-04-09 14:01:52 +0300 (Thu, 09 Apr 2009) | 15 lines
              branches/5.1:
              
              Fix Bug#43660 SHOW INDEXES/ANALYZE does NOT update cardinality for indexes
              of InnoDB table
              
              by replacing the PRNG that is used to pick random pages with a better
              one.
              
              This is based on r4670 but also adds a new configuration option and
              enables the fix only if this option is changed. Please skip the present
              revision when merging.
              
              Approved by:	Heikki (via email)
            ------------------------------------------------------------
            revno: 2852.13.2
            committer: Satya B <satya.bn@sun.com>
            branch nick: mysql-5.1-bugteam-innodb
            timestamp: Wed 2009-04-15 17:58:07 +0530
            message:
              Applying InnoDB snashot 5.1-ss4699, part 2. Fixes BUG#43309
              
              1) BUG#43309 - Test main.innodb can't be run twice
              
              2) Follow up fix for BUG#43309, adds explanatory comments.
              
              Detailed revision comments:
              
              r4575 | vasil | 2009-03-30 15:55:31 +0300 (Mon, 30 Mar 2009) | 8 lines
              branches/5.1:
              
              Fix Bug#43309 Test main.innodb can't be run twice
              
              Make the innodb mysql-test more flexible by inspecting how much a
              variable of interest has changed since the start of the test. Do not
              assume the variables have zero values at the start of the test.
              
              r4659 | vasil | 2009-04-06 15:34:51 +0300 (Mon, 06 Apr 2009) | 6 lines
              branches/5.1:
              
              Followup to r4575 and the fix of Bug#43309 Test main.innodb can't be run twice:
              
              Add an explanatory comment, as suggested by Patrick Crews in the bug report.
            ------------------------------------------------------------
            revno: 2852.13.1
            committer: Satya B <satya.bn@sun.com>
            branch nick: mysql-5.1-bugteam-innodb
            timestamp: Wed 2009-04-15 17:16:08 +0530
            message:
              Applying InnoDB snashot 5.1-ss4699, part 1. Fixes BUG#39320 and other
              problems
              
              1) BUG#39320 - innodb crash in file btr/btr0pcur.c line 217 with 
                             innodb_locks_unsafe_for_binlog
              
              2) Fixes bug in multi-table semi consistent reads.
              
              3) Fixes email address from dev@innodb.com to innodb_dev_ww@oracle.com
              
              4) Fixes warning message generated by main.innodb test
              
              
              Detailed revision comments:
              
              r4399 | marko | 2009-03-12 09:38:05 +0200 (Thu, 12 Mar 2009) | 5 lines
              branches/5.1: row_sel_get_clust_rec_for_mysql(): Store the cursor position
              also for unlock_row().  (Bug #39320)
              
              rb://96 approved by Heikki Tuuri.
              
              r4400 | marko | 2009-03-12 10:06:44 +0200 (Thu, 12 Mar 2009) | 8 lines
              branches/5.1: Fix a bug in multi-table semi-consistent reads.
              Remember the acquired record locks per table handle (row_prebuilt_t)
              rather than per transaction (trx_t), so that unlock_row should successfully
              unlock all non-matching rows in multi-table operations.
              This deficiency was found while investigating Bug #39320.
              
              rb://94 approved by Heikki Tuuri.
              
              r4481 | marko | 2009-03-19 15:01:48 +0200 (Thu, 19 Mar 2009) | 6 lines
              branches/5.1: row_unlock_for_mysql(): Do not unlock records that were
              modified by the current transaction.  This bug was introduced or unmasked
              in r4400.
              
              rb://97 approved by Heikki Tuuri
              
              r4573 | vasil | 2009-03-30 14:17:13 +0300 (Mon, 30 Mar 2009) | 4 lines
              branches/5.1:
              
              Fix email address from dev@innodb.com to innodb_dev_ww@oracle.com
              
              r4574 | vasil | 2009-03-30 14:27:08 +0300 (Mon, 30 Mar 2009) | 38 lines
              branches/5.1:
              
              Restore the state of INNODB_THREAD_CONCURRENCY to silence this warning:
              
                TEST                                      RESULT   TIME (ms)
                ------------------------------------------------------------
                
                worker[1] Using MTR_BUILD_THREAD 250, with reserved ports 12500..12509
                main.innodb                              [ pass ]   8803
                
                MTR's internal check of the test case 'main.innodb' failed.
                This means that the test case does not preserve the state that existed
                before the test case was executed.  Most likely the test case did not
                do a proper clean-up.
                This is the diff of the states of the servers before and after the
                test case was executed:
                mysqltest: Logging to '/tmp/autotest.sh-20090330_033000-5.1.5Hg8CY/mysql-5.1/mysql-test/var/tmp/check-mysqld_1.log'.
                mysqltest: Results saved in '/tmp/autotest.sh-20090330_033000-5.1.5Hg8CY/mysql-5.1/mysql-test/var/tmp/check-mysqld_1.result'.
                mysqltest: Connecting to server localhost:12500 (socket /tmp/autotest.sh-20090330_033000-5.1.5Hg8CY/mysql-5.1/mysql-test/var/tmp/mysqld.1.sock) as 'root', connection 'default', attempt 0 ...
                mysqltest: ... Connected.
                mysqltest: Start processing test commands from './include/check-testcase.test' ...
                mysqltest: ... Done processing test commands.
                --- /tmp/autotest.sh-20090330_033000-5.1.5Hg8CY/mysql-5.1/mysql-test/var/tmp/check-mysqld_1.result	2009-03-30 14:12:31.000000000 +0300
                +++ /tmp/autotest.sh-20090330_033000-5.1.5Hg8CY/mysql-5.1/mysql-test/var/tmp/check-mysqld_1.reject	2009-03-30 14:12:41.000000000 +0300
                @@ -99,7 +99,7 @@
                 INNODB_SUPPORT_XA	ON
                 INNODB_SYNC_SPIN_LOOPS	20
                 INNODB_TABLE_LOCKS	ON
                -INNODB_THREAD_CONCURRENCY	8
                +INNODB_THREAD_CONCURRENCY	16
                 INNODB_THREAD_SLEEP_DELAY	10000
                 INSERT_ID	0
                 INTERACTIVE_TIMEOUT	28800
                
                mysqltest: Result content mismatch
                
                not ok
              
              r4576 | vasil | 2009-03-30 16:25:10 +0300 (Mon, 30 Mar 2009) | 4 lines
              branches/5.1:
              
              Revert a change to Makefile.am that I committed accidentally in c4574.
        ------------------------------------------------------------
        revno: 2852.1.6
        committer: Chad MILLER <chad@mysql.com>
        branch nick: 5.1-bugteam
        timestamp: Fri 2009-04-17 16:00:53 -0400
        message:
          Move test for bug 39559, which uses command-line mysql client
          to separate test file that doesn't permit mysqld embedded in 
          mysqltest.
          
          Also, fix different comment handling in a incorrect new-to-5.1 
          test.
        ------------------------------------------------------------
        revno: 2852.1.5
        committer: Davi Arnaut <Davi.Arnaut@Sun.COM>
        branch nick: 44164-5.1
        timestamp: Tue 2009-04-14 14:05:32 +0200
        message:
          Bug#44164: TL_WRITE has no description in lock_descriptions[]
          
          The problem was that new lock types were being added without a
          corresponding description. Since the lock types (enum values)
          are used as indices to the description array, the descriptions
          could be shifted depending on the lock type. The solution is to
          ensure that every lock type has a correspondent description.
        ------------------------------------------------------------
        revno: 2852.1.4
        committer: Sergey Glukhov <Sergey.Glukhov@sun.com>
        branch nick: mysql-5.1-bugteam
        timestamp: Tue 2009-04-14 19:17:44 +0500
        message:
          5.0-bugteam->5.1-bugteam merge
            ------------------------------------------------------------
            revno: 1810.3883.9
            committer: Sergey Glukhov <Sergey.Glukhov@sun.com>
            branch nick: mysql-5.0-bugteam
            timestamp: Tue 2009-04-14 19:16:30 +0500
            message:
              Bug#41268 Help Text for \c is misleading in client command line interface(addon)
              fixed message for 'help' command
        ------------------------------------------------------------
        revno: 2852.1.3
        committer: Tatiana A. Nurnberg <azundris@mysql.com>
        branch nick: 51-43835
        timestamp: Tue 2009-04-14 17:09:19 +0200
        message:
          auto-merge
            ------------------------------------------------------------
            revno: 2852.2.23
            committer: Gleb Shchepa <gshchepa@mysql.com>
            branch nick: mysql-5.1-bugteam
            timestamp: Tue 2009-04-14 19:19:15 +0500
            message:
              Bug #42563: Message tells me to repair table though Storage
                          Engine doesn't allow me to.
              
              In case of incompatible changes between old and new table
              versions, the mysqlcheck program prints error messages like
              this:
                error: Table upgrade required. Please do
                       "REPAIR TABLE `table_name`" to fix it!
              
              However, InnoDB doesn't support REPAIR TABLE query, so the
              message is confusing.
              
              
              Error message text has been changed to:
              
                Table upgrade required. Please do "REPAIR TABLE `table_name`"
                or dump/reload to fix it!"
            ------------------------------------------------------------
            revno: 2852.2.22
            committer: Narayanan V <v.narayanan@sun.com>
            branch nick: mysql-5.1-bugteam-testcases-1
            timestamp: Tue 2009-04-14 16:32:55 +0530
            message:
              Importing test cases for IBMDB2I
              
              The current patch
              
              -- Adds the ibmdb2i suite
              -- related include(.inc) files
              -- tests for Bug#44020 and Bug#44025
        ------------------------------------------------------------
        revno: 2852.1.2
        committer: Tatiana A. Nurnberg <azundris@mysql.com>
        branch nick: 51-43835
        timestamp: Tue 2009-04-14 16:38:55 +0200
        message:
          auto-merge
            ------------------------------------------------------------
            revno: 2852.2.21
            committer: Sergey Glukhov <Sergey.Glukhov@sun.com>
            branch nick: mysql-5.1-bugteam
            timestamp: Mon 2009-04-13 18:09:10 +0500
            message:
              Bug#43385 Cannot ALTER DATABASE ... UPGRADE DATA DIRECTORY NAME when Views exist(addon)
              mysql_rename_view can not rename view if database is not the same.
              The fix is to add new argument 'new_db' to mysql_rename_view() and
              allow rename with different databases
              (only for ALTER DATABASE ... UPGRADE DATA DIRECTORY NAME).
            ------------------------------------------------------------
            revno: 2852.2.20
            committer: Narayanan V <v.narayanan@sun.com>
            branch nick: mysql-5.1-bugteam-44025-1
            timestamp: Mon 2009-04-13 17:05:40 +0530
            message:
              merging with mysql-5.1-bugteam
                ------------------------------------------------------------
                revno: 2852.12.1
                committer: Narayanan V <v.narayanan@sun.com>
                branch nick: mysql-5.1-bugteam-44025
                timestamp: Fri 2009-04-10 13:18:07 +0530
                message:
                  Bug#44025 Some schema names longer than 8 characters not supported  by IBMDB2I
                  
                  On IBM i 5.4, schemas with names that are longer 
                  than 8 characters and contain digits or an underscore
                  cannot contain IBMDB2I tables, even though this should
                  theoritically be possible if all alpha characters
                  are uppercase.
                  
                  THe current patch fixes the IBMDB2I engine to
                  allow digits and the underscore(_) to be used in
                  schema names longer than 8 characters on IBM i 5.4.
            ------------------------------------------------------------
            revno: 2852.2.19
            committer: Narayanan V <v.narayanan@sun.com>
            branch nick: mysql-5.1-bugteam-44022-1
            timestamp: Mon 2009-04-13 16:51:24 +0530
            message:
              merging with mysql-5.1-bugteam tree
                ------------------------------------------------------------
                revno: 2852.11.1
                committer: Narayanan V <v.narayanan@sun.com>
                branch nick: mysql-5.1-bugteam-44022
                timestamp: Fri 2009-04-10 13:01:15 +0530
                message:
                  Bug#44022 CREATE TABLE sometimes fails silently for IBMDB2I engine
                  
                  In some circumstances, when a table is created with
                  the IBMDB2I engine, the CREATE TABLE statement will
                  return successfully but the table will not exist.
                  
                  The current patch addresses the above issue and causes
                  CREATE to fail and report and error to the user.
            ------------------------------------------------------------
            revno: 2852.2.18
            committer: Narayanan V <v.narayanan@sun.com>
            branch nick: mysql-5.1-bugteam-44020-1
            timestamp: Mon 2009-04-13 16:26:21 +0530
            message:
              merging with mysql-5.1-bugteam tree
                ------------------------------------------------------------
                revno: 2852.10.1
                committer: Narayanan V <v.narayanan@sun.com>
                branch nick: mysql-5.1-bugteam-44020
                timestamp: Fri 2009-04-10 11:56:54 +0530
                message:
                  Bug#44020 Unicode Swedish collations not working with IBMDB2I
                  
                  The utf8_swedish_ci and ucs2_swedish_ci
                  collations do not work with indexes on 
                  IBMDB2I tables.
                  
                  The current patch adds the mapping for
                  ucs2_swedish collation and removes the 
                  ucs2_spanish2 mapping which is not
                  supported by any version of the operating
                  system.
            ------------------------------------------------------------
            revno: 2852.2.17
            committer: Chad MILLER <chad@mysql.com>
            branch nick: 5.1-bugteam
            timestamp: Fri 2009-04-10 10:18:57 -0400
            message:
              Merge fix for bug 39559 and bugteam trunk.
                ------------------------------------------------------------
                revno: 2806.45.1
                committer: Chad MILLER <chad@mysql.com>
                branch nick: 5.1-bugteam--bug39559
                timestamp: Thu 2009-04-09 22:18:18 -0400
                message:
                  Bug#39559: dump of stored procedures / functions with C-style \
                  	comment can't be read back
                  
                  A change to the lexer in 5.1 caused slash-asterisk-bang-version
                  sections to be terminated early if there exists a slash-asterisk-
                  style comment inside it.  Nesting comments is usually illegal,
                  but we rely on versioned comment blocks in mysqldump, and the
                  contents of those sections must be allowed to have comments.
                  
                  The problem was that when encountering open-comment tokens and
                  consuming -or- passing through the contents, the "in_comment"
                  state at the end was clobbered with the not-in-a-comment value,
                  regardless of whether we were in a comment before this or not.  
                  
                  So, """/*!VER one /* two */ three */""" would lose its in-comment
                  state between "two" and "three".  Save the echo and in-comment
                  state, and restore it at the end of the comment if we consume a 
                  comment.
            ------------------------------------------------------------
            revno: 2852.2.16
            committer: Sergey Glukhov <Sergey.Glukhov@sun.com>
            branch nick: mysql-5.1-bugteam
            timestamp: Fri 2009-04-10 14:25:48 +0500
            message:
              Bug#43385 Cannot ALTER DATABASE ... UPGRADE DATA DIRECTORY NAME when Views exist
              allow 'rename view' for ALTER ...UPGRADE DATA DIRECTORY NAME command.
              it's safe because a view has valid internal db&table names in this case.
            ------------------------------------------------------------
            revno: 2852.2.15
            committer: Davi Arnaut <Davi.Arnaut@Sun.COM>
            branch nick: 43706-5.1
            timestamp: Thu 2009-04-09 12:25:25 -0300
            message:
              Bug#43706: libmysqld segfaults when re-intialised
              Bug#44091: libmysqld gets stuck waiting on mutex on initialization
              
              The problem was that libmysqld wasn't enforcing a certain
              initialization and deinitialization order for the mysys
              library. Another problem was that the global object used
              for management of log event handlers (aka LOGGER) wasn't
              being prepared for a possible reutilization.
              
              What leads to the hang/crash reported is that a failure
              to load the language file triggers a double call of the
              cleanup functions, causing an already destroyed mutex to
              be used.
              
              The solution is enforce a order on the initialization and
              deinitialization of the mysys library within the libmysqld
              library and to ensure that the global LOGGER object reset
              it's internal state during cleanup.
            ------------------------------------------------------------
            revno: 2852.2.14
            committer: Luis Soares <luis.soares@sun.com>
            branch nick: 5.1-bt-backport
            timestamp: Thu 2009-04-09 12:30:44 +0100
            message:
              manual merge: 5.0-bugteam --> 5.1-bugteam
              Note: empty changeset.
                ------------------------------------------------------------
                revno: 1810.3883.8
                committer: Luis Soares <luis.soares@sun.com>
                branch nick: 5.0-bt
                timestamp: Thu 2009-04-09 11:40:22 +0100
                message:
                  BUG#13684: SP: DROP PROCEDURE|FUNCTION IF EXISTS not binlogged if
                  routine does not exist 
                        
                  There is an inconsistency with DROP DATABASE IF EXISTS, DROP TABLE IF
                  EXISTS and DROP VIEW IF EXISTS: those are binlogged even if the DB or
                  TABLE does not exist, whereas DROP PROCEDURE IF EXISTS does not. It
                  would be nice or at least consistent if DROP PROCEDURE/STATEMENT
                  worked the same too.
                        
                  Fixed DROP PROCEDURE|FUNCTION IF EXISTS by adding a call to
                  mysql_bin_log.write in mysql_execute_command. Checked also if all 
                  documented "DROP (...) IF EXISTS" get binlogged.
                        
                  NOTE: This is a 5.0 backport patch as requested by support.
            ------------------------------------------------------------
            revno: 2852.2.13
            committer: Narayanan V <v.narayanan@sun.com>
            branch nick: mysql-5.1-bugteam-37631-4
            timestamp: Thu 2009-04-09 16:04:28 +0530
            message:
              merging with mysql-5.1-bugteam
                ------------------------------------------------------------
                revno: 2852.9.1
                committer: Narayanan V <v.narayanan@sun.com>
                branch nick: mysql-5.1-bugteam-37631-3
                timestamp: Thu 2009-04-09 14:04:34 +0530
                message:
                  merging with mysql-5.1-bugteam tree
                ------------------------------------------------------------
                revno: 2852.8.1
                committer: Narayanan V <v.narayanan@sun.com>
                branch nick: mysql-5.1-bugteam-37631-2
                timestamp: Wed 2009-04-08 12:25:19 +0530
                message:
                  Bug#37631 Incorrect key file for table after upgrading from 5.0 to 5.1
                  
                  The conformance checker was not taking into
                  account, and, making concessions for acceptable
                  incompatibilites in tables created by
                  versions earlier than 4.1.
                  
                  The current patch relaxes the conformance
                  checker to ignore differences in key_alg
                  and language for tables created by versions
                  earlier than 4.1.
            ------------------------------------------------------------
            revno: 2852.2.12
            committer: Sergey Glukhov <Sergey.Glukhov@sun.com>
            branch nick: mysql-5.1-bugteam
            timestamp: Thu 2009-04-09 14:58:23 +0500
            message:
              null merge
                ------------------------------------------------------------
                revno: 1810.3883.7
                committer: Sergey Glukhov <Sergey.Glukhov@sun.com>
                branch nick: mysql-5.0-bugteam
                timestamp: Thu 2009-04-09 14:55:23 +0500
                message:
                  auotmerge
            ------------------------------------------------------------
            revno: 2852.2.11
            committer: Sergey Glukhov <Sergey.Glukhov@sun.com>
            branch nick: mysql-5.1-bugteam
            timestamp: Thu 2009-04-09 14:57:30 +0500
            message:
              null merge
                ------------------------------------------------------------
                revno: 2852.7.1
                committer: He Zhenxing <zhenxing.he@sun.com>
                branch nick: 5.1-bugteam
                timestamp: Thu 2009-04-09 17:24:36 +0800
                message:
                  Null merge the fix only for 5.0-bugteam
                ------------------------------------------------------------
                revno: 1810.3884.1
                committer: He Zhenxing <zhenxing.he@sun.com>
                branch nick: 5.0-bugteam
                timestamp: Thu 2009-04-09 16:58:18 +0800
                message:
                  Fix compile error on windows for BUG#37145 on 5.0-bugteam
            ------------------------------------------------------------
            revno: 2852.2.10
            committer: Sergey Glukhov <Sergey.Glukhov@sun.com>
            branch nick: mysql-5.1-bugteam
            timestamp: Thu 2009-04-09 14:38:50 +0500
            message:
              5.0-bugteam->5.1-bugteam merge
                ------------------------------------------------------------
                revno: 1810.3883.6
                committer: Sergey Glukhov <Sergey.Glukhov@sun.com>
                branch nick: mysql-5.0-bugteam
                timestamp: Thu 2009-04-09 14:19:31 +0500
                message:
                  Bug#43833 Simple INSERT crashes the server
                  The crash happens due to wrong 'digits' variable value(0),
                  'digits' can not be 0, so the fix is use 1 as min allowed value.
            ------------------------------------------------------------
            revno: 2852.2.9
            committer: Narayanan V <v.narayanan@sun.com>
            branch nick: mysql-5.1-bugteam-38848
            timestamp: Thu 2009-04-09 13:48:23 +0530
            message:
              Bug#38848 myisam_use_mmap causes widespread myisam corruption on windows
                          
              Currently the memory map is being created
              with a size that is greater than the size 
              of the underlying datafile. This can cause
              varying behaviour,
              
              e.g. 
              
              In windows the size of the datafile
              is increased, while on linux it remains
              the same.
              
              This fix removes the increment margin to
              the size that is used while creating the
              memory map.
            ------------------------------------------------------------
            revno: 2852.2.8
            committer: Anurag Shekhar <anurag.shekhar@sun.com>
            branch nick: mysql-5.1-bugteam
            timestamp: Thu 2009-04-09 13:36:47 +0530
            message:
              merging with 5.0 bugteam tree
                ------------------------------------------------------------
                revno: 1810.3883.5
                committer: Anurag Shekhar <anurag.shekhar@sun.com>
                branch nick: mysql-5.0-bugteam-fresh
                timestamp: Thu 2009-04-09 13:30:04 +0530
                message:
                  merging with 5.0-bugteam tree.
                ------------------------------------------------------------
                revno: 1810.3881.4
                committer: Anurag Shekhar <anurag.shekhar@sun.com>
                branch nick: mysql-5.0-43950
                timestamp: Wed 2009-04-08 16:45:43 +0530
                message:
                  Bug #43950 myisamchk shows negative value for 'Max keyfile length'  
                  While printing the Max keyfile length 'llstr' call was used which 
                  was treating the max_key_file_length as negative.
                  
                  Changing this to ullstr fixes the problem. 
                  myisamchk output will differ in 32 bit and 64 bit Operating systems 
                  so its not possible to have test case for this bug.
            ------------------------------------------------------------
            revno: 2852.2.7
            committer: He Zhenxing <zhenxing.he@sun.com>
            branch nick: 5.1-bugteam
            timestamp: Thu 2009-04-09 15:47:06 +0800
            message:
              Null merge from 5.0-bugteam
                ------------------------------------------------------------
                revno: 1810.3883.4
                committer: He Zhenxing <zhenxing.he@sun.com>
                branch nick: 5.0-bugteam
                timestamp: Thu 2009-04-09 15:42:59 +0800
                message:
                  post fix compiling problem after push BUG#37145 to 5.0-bugteam
            ------------------------------------------------------------
            revno: 2852.2.6
            committer: He Zhenxing <zhenxing.he@sun.com>
            branch nick: 5.1-bugteam
            timestamp: Thu 2009-04-09 14:31:09 +0800
            message:
              Auto merge
                ------------------------------------------------------------
                revno: 2852.6.2
                committer: Alfranio Correia <alfranio.correia@sun.com>
                branch nick: mysql-5.1-bugteam-push
                timestamp: Wed 2009-04-08 22:02:19 +0100
                message:
                  BUG#39393. Post-fix for test rpl_skip_error.
                  
                  The result set for multi-row statements is not the same between STMT and
                  RBR and among different versions. Thus to avoid test failures, we are not
                  printing out such result sets. Note, however, that this does not have
                  impact on coverage and accuracy since the execution is able to continue
                  without further issues when an error is found on the master and such error
                  is set to be skipped.
                ------------------------------------------------------------
                revno: 2852.6.1
                committer: Alfranio Correia <alfranio.correia@sun.com>
                branch nick: mysql-5.1-bugteam-push
                timestamp: Wed 2009-04-08 11:07:24 +0100
                message:
                  merge 5.1-bugteam --> 5.1-bugteam (local)
                ------------------------------------------------------------
                revno: 2839.1.1
                committer: Alfranio Correia <alfranio.correia@sun.com>
                branch nick: mysql-5.1-bugteam
                timestamp: Sun 2009-04-05 13:03:04 +0100
                message:
                  BUG#39393 slave-skip-errors does not work when using ROW based replication
                                                
                  RBR was not considering the option --slave-skip-errors.
                                                
                  To fix the problem, we are reporting the ignored ERROR(s) as warnings thus avoiding 
                  stopping the SQL Thread. Besides, it fixes the output of "SHOW VARIABLES LIKE 
                  'slave_skip_errors'" which was showing nothing when the value "all" was assigned 
                  to --slave-skip-errors.
                                    
                  @sql/log_event.cc
                    skipped rbr errors when the option skip-slave-errors is set.
                  @sql/slave.cc
                    fixed the output of for SHOW VARIABLES LIKE 'slave_skip_errors'"
                  @test-cases
                    fixed the output of rpl.rpl_idempotency
                    updated the test case rpl_skip_error
            ------------------------------------------------------------
            revno: 2852.2.5
            committer: He Zhenxing <zhenxing.he@sun.com>
            branch nick: 5.1-bugteam
            timestamp: Thu 2009-04-09 14:22:06 +0800
            message:
              Post fix of BUG#37145
              
              Binlog the CREATE EVENT unless the created event been successfully dropped
              
              Modified Query_log_event constructor to make sure that error_code
              is not set to ER_SERVER_SHUTDOWN or ER_QUERY_INTERRUPTED errors
              when NOT_KILLED
            ------------------------------------------------------------
            revno: 2852.2.4
            committer: He Zhenxing <zhenxing.he@sun.com>
            branch nick: 5.1-bugteam
            timestamp: Thu 2009-04-09 07:58:57 +0800
            message:
              auto merge from 5.0-bugteam
                ------------------------------------------------------------
                revno: 1810.3883.3
                committer: He Zhenxing <zhenxing.he@sun.com>
                branch nick: 5.0-bugteam
                timestamp: Thu 2009-04-09 07:53:21 +0800
                message:
                  auto merge
                    ------------------------------------------------------------
                    revno: 1810.3881.3
                    committer: Satya B <satya.bn@sun.com>
                    branch nick: mysql-5.0-bugteam-41330
                    timestamp: Tue 2009-04-07 18:42:51 +0530
                    message:
                      merge to latest 5.0-bugteam
                ------------------------------------------------------------
                revno: 1810.3883.2
                committer: He Zhenxing <zhenxing.he@sun.com>
                branch nick: 5.0-bugteam
                timestamp: Wed 2009-04-08 16:17:26 +0800
                message:
                  Auto merge
            ------------------------------------------------------------
            revno: 2852.2.3
            committer: He Zhenxing <zhenxing.he@sun.com>
            branch nick: 5.1-bugteam
            timestamp: Thu 2009-04-09 07:42:51 +0800
            message:
              Manually merge BUG#37145 to 5.1-bugteam
                ------------------------------------------------------------
                revno: 1810.3883.1
                committer: He Zhenxing <zhenxing.he@sun.com>
                branch nick: 5.0-bugteam
                timestamp: Fri 2009-03-27 13:19:50 +0800
                message:
                  BUG#37145 Killing a statement doing DDL may log binlog event with error code 1053
                  
                  When the thread executing a DDL was killed after finished its
                  execution but before writing the binlog event, the error code in
                  the binlog event could be set wrongly to ER_SERVER_SHUTDOWN or
                  ER_QUERY_INTERRUPTED.
                  
                  This patch fixed the problem by ignoring the kill status when
                  constructing the event for DDL statements.
                  
                  This patch also included the following changes in order to
                  provide the test case.
                  
                   1) modified mysqltest to support variable for connection command
                  
                   2) modified mysql-test-run.pl, add new variable MYSQL_SLAVE to
                      run mysql client against the slave mysqld.
            ------------------------------------------------------------
            revno: 2852.2.2
            committer: Satya B <satya.bn@sun.com>
            branch nick: mysql-5.1-bugteam-41330
            timestamp: Tue 2009-04-07 18:44:37 +0530
            message:
              merge to latest 5.1-bugteam
                ------------------------------------------------------------
                revno: 2852.3.7
                committer: Satya B <satya.bn@sun.com>
                branch nick: mysql-5.1-bugteam-43973
                timestamp: Tue 2009-04-07 17:06:15 +0530
                message:
                  merge 5.0-bugteam to 5.1-bugteam
                    ------------------------------------------------------------
                    revno: 1810.3882.3
                    committer: Satya B <satya.bn@sun.com>
                    branch nick: mysql-5.0-bugteam-43973
                    timestamp: Tue 2009-04-07 16:54:32 +0530
                    message:
                      Fix for Bug #43973 - backup_myisam.test fails on 6.0-bugteam
                            
                      The test started failing following the push for BUG#41541.
                      Some of the algorithms access bytes beyond the input data
                      and this can affect up to one byte less than "word size"
                      which is BITS_SAVED / 8. 
                            
                      Fixed by adding (BITS_SAVED / 8) -1 bytes to buffer size
                      (i.e. Memory Segment #2) to avoid accessing un-allocated data.
                ------------------------------------------------------------
                revno: 2852.3.6
                committer: Alexander Barkov <bar@mysql.com>
                branch nick: mysql-5.1-bugteam
                timestamp: Tue 2009-04-07 11:48:38 +0500
                message:
                  Bug#42649 THR_LOCK_charset global mutex abused by InnoDB
                  The patch was originally proposed by Mikael and reviewed by Bar.
                ------------------------------------------------------------
                revno: 2852.3.5
                committer: Alfranio Correia <alfranio.correia@sun.com>
                branch nick: mysql-5.1-bugteam-push
                timestamp: Mon 2009-04-06 01:22:34 +0100
                message:
                  merge 5.1-bugteam --> 5.1-bugteam (local)
                    ------------------------------------------------------------
                    revno: 2760.9.1
                    committer: Alfranio Correia <alfranio.correia@sun.com>
                    branch nick: mysql-5.1-bugteam
                    timestamp: Wed 2009-02-11 11:56:25 +0000
                    message:
                      BUG#38197 Errors in @@init_slave not visible in 'show slave status'
                            
                      Some errors that cause the slave SQL thread to stop are not shown in the
                      Slave_SQL_Error column of "SHOW SLAVE STATUS". Instead, the error is only 
                      in the server's error log.
                            
                      That makes it difficult to analyze the error for the user. One example of an error
                      that stops the slave but is not shown by "SHOW SLAVE STATUS" is when @@global.init_slave
                      is set incorrectly (e.g., it contains something that is not valid SQL).
                            
                      Three failures were not correctly reported:
                            
                      1 - Failures during slave thread initialization
                      2 - Failures while initializing the relay log position right after
                      starting the slave thread.
                      3 - Failures while processing queries passed through the init_slave
                      option.
                            
                      This patch fixes the issues by reporting the errors through relay-info->report.
                ------------------------------------------------------------
                revno: 2852.3.4
                committer: Serge Kozlov <Serge.Kozlov@sun.com>
                branch nick: push-5.1-bugteam
                timestamp: Sat 2009-04-04 01:33:13 +0400
                message:
                   Bug#37716.
                  1. Test case was rewritten completely.
                  2. Test covers 3 cases:
                   a) do deadlock on slave, wait retries of transaction, unlock slave before lock
                  timeout;
                   b) do deadlock on slave and wait error 'lock timeout exceed' on slave;
                   c) same as b) but if of max relay log size = 0;
                  3. Added comments inline.
                  4. Updated result file.
                ------------------------------------------------------------
                revno: 2852.3.3
                committer: Davi Arnaut <Davi.Arnaut@Sun.COM>
                branch nick: 43230-5.1
                timestamp: Fri 2009-04-03 16:46:00 -0300
                message:
                  Merge Bug#43230 into mysql-5.1-bugteam
                    ------------------------------------------------------------
                    revno: 1810.3882.2
                    committer: Davi Arnaut <Davi.Arnaut@Sun.COM>
                    branch nick: 43230-5.0
                    timestamp: Fri 2009-04-03 16:11:54 -0300
                    message:
                      Bug#43230: SELECT ... FOR UPDATE can hang with FLUSH TABLES WITH READ LOCK indefinitely
                      
                      The problem is that a SELECT .. FOR UPDATE statement might open
                      a table and later wait for a impeding global read lock without
                      noticing whether it is holding a table that is being waited upon
                      the the flush phase of the process that took the global read
                      lock.
                      
                      The same problem also affected the following statements:
                      
                      LOCK TABLES .. WRITE
                      UPDATE .. SET (update and multi-table update)
                      TRUNCATE TABLE ..
                      LOAD DATA ..
                      
                      The solution is to make the above statements wait for a impending
                      global read lock before opening the tables. If there is no
                      impending global read lock, the statement raises a temporary
                      protection against global read locks and progresses smoothly
                      towards completion.
                      
                      Important notice: the patch does not try to address all possible
                      cases, only those which are common and can be fixed unintrusively
                      enough for 5.0.
                ------------------------------------------------------------
                revno: 2852.3.2
                committer: Guangbao Ni <gni@mysql.com>
                branch nick: bugteam-5.1-bug42640
                timestamp: Fri 2009-04-03 18:42:00 +0000
                message:
                  AutoMerged from pushbuild mysql-5.1-bugteam
                    ------------------------------------------------------------
                    revno: 2852.4.3
                    committer: Horst Hunger <horst@mysql.com>
                    branch nick: mysql-5.1-42838
                    timestamp: Fri 2009-04-03 11:37:48 +0200
                    message:
                      Fix belonging to bug#42838: Though this bug is only for 6.0 I put in some updated result files for 6.0 and this are the corrsponding resul files for 5.1, so that sys_vars should then run successfully also in 5.1.
                    ------------------------------------------------------------
                    revno: 2852.4.2
                    committer: Patrick Crews <patrick.crews@sun.com>
                    branch nick: mysql-5.1-new
                    timestamp: Thu 2009-04-02 18:41:01 -0400
                    message:
                      merge
                        ------------------------------------------------------------
                        revno: 2852.5.1
                        committer: Chad MILLER <chad@mysql.com>
                        branch nick: mysql-5.1-bugteam
                        timestamp: Thu 2009-04-02 15:42:29 -0400
                        message:
                          Merge revert of bug32136 into 5.1.
                        ------------------------------------------------------------
                        revno: 1810.3882.1
                        committer: Chad MILLER <chad@mysql.com>
                        branch nick: mysql-5.0-bugteam--bug32136
                        timestamp: Thu 2009-04-02 11:29:28 -0400
                        message:
                          Bug#43876: mysqld_multi introduces --no-defaults which screws up my system
                          Bug#32136: mysqld_multi --defaults-file not respected while using \
                          	--mysqld=mysqld_safe
                          
                          Revert change that adds "--no-defaults" to mysqld_multi.
                          
                          This closes Bug#43508 and re-opens Bug#32136.
                    ------------------------------------------------------------
                    revno: 2852.4.1
                    committer: Patrick Crews <patrick.crews@sun.com>
                    branch nick: mysql-5.1-new
                    timestamp: Thu 2009-04-02 18:34:18 -0400
                    message:
                      Bug#43716: Test mysqlbinlog_row_big is failing, needs to be updated
                      
                      Altered the test to accommodate the new behavior of max_allowed_packet.
                      Had to disconnect / reconnect the default connection for the new value to register.
                      Re-enabled certain parts of the test that were commented out and added
                      some setup / cleanup code to ensure proper reset of max_allowed_packet at the end of the test.
                      
                      Re-recorded the .result file to account for changes to the test.
                ------------------------------------------------------------
                revno: 2852.3.1
                committer: Guangbao Ni <gni@mysql.com>
                branch nick: bugteam-5.1-bug42640
                timestamp: Fri 2009-04-03 18:21:57 +0000
                message:
                  BUG#42640 mysqld crashes when unsafe statements are executed (STRICT_TRANS_TABLESmode)
                  
                  Mysql server crashes because unsafe statements warning is wrongly elevated to error,
                  which is set the error status of Diagnostics_area of the thread in THD::binlog_query().
                  Yet the caller believes that binary logging shouldn't touch the status, so it will
                  set the status also later by my_ok(), my_error() or my_message() seperately
                  according to the execution result of the statement or transaction.
                  But the status of Diagnostics_area of the thread is allowed to set only once.
                  
                  Fixed to clear the error wrongly set by binary logging, but keep the warning message.
            ------------------------------------------------------------
            revno: 2852.2.1
            committer: Satya B <satya.bn@sun.com>
            branch nick: mysql-5.1-bugteam-41330
            timestamp: Mon 2009-04-06 12:31:17 +0530
            message:
              merge 5.0-bugteam to 5.1-bugteam
            ------------------------------------------------------------
            revno: 1810.3881.2
            committer: Satya B <satya.bn@sun.com>
            branch nick: mysql-5.0-bugteam-41330
            timestamp: Thu 2009-04-02 14:30:44 +0530
            message:
              merge to 5.0-bugteam
            ------------------------------------------------------------
            revno: 1810.3881.1
            committer: Satya B <satya.bn@sun.com>
            branch nick: mysql-5.0-bugteam-41330
            timestamp: Fri 2009-03-20 14:48:14 +0530
            message:
              Fix for BUG#41330 -Myisam table open count set to zero before index blocks 
                                 are written.
                    
              When we have a myisam table with DELAY_KEY_WRITE option, index updates
              are not applied until the flush tables command is issued or until the
              server is shutdown. If server gets killed before the index updates are 
              written to disk, the index file is corrupted as expected but the table 
              is not marked as crashed. So when we start server with myisam-recover,
              table is not repaired leaving the table unusable.
                    
              The problem is when we try to write the index updates to index file,
              we decrement the open_count even before the flushing the keys to index
              file.
                    
              Fixed by moving the decrement operation after flushing the keys to the
              index file. So we always have non zero open count if the flush table
              operation is killed and when the server is started with mysiam-recover
              option, it marks the table as crashed and repairs it.
                    
              Note: No testcase for added as we need to kill the server and start the 
                    server with different set of options and other non trivial
                    operations involved.
        ------------------------------------------------------------
        revno: 2852.1.1
        committer: Tatiana A. Nurnberg <azundris@mysql.com>
        branch nick: 51-43835
        timestamp: Mon 2009-04-06 13:42:33 +0200
        message:
          Bug#43835: SHOW VARIABLES does not include 0 for slave_skip_errors
          
          We didn't expect "error: no error", although this is
          in fact a legitimate state (if something is erroneous
          on the master, but not on the slave, e.g. INSERT fails
          on master due to UNIQUE constraint which does not exist
          on slave).
          
          We now list the ignore for "0: no error" the same way
          as any other ignore; moreover, if no or an empty
          --slave-skip-errors is passed at start-up, we show
          "OFF" instead of empty list, as intended. (The code
          for that was there, but was only run for the empty-
          argument case, even if it subsequently tested for
          both conditions.) 
    ------------------------------------------------------------
    revno: 2828.9.2
    author: kent.boort@sun.com
    committer: Kent Boortz <kent@kent-amd64>
    branch nick: mysql-5.1
    timestamp: Tue 2009-05-05 16:27:35 +0200
    message:
      Added clarification about GPL v2, changed to Sun Microsystems, Inc.
    ------------------------------------------------------------
    revno: 2828.9.1
    committer: Jonathan Perkin <jperkin@sun.com>
    branch nick: mysql-5.1
    timestamp: Thu 2009-04-16 20:43:24 +0200
    message:
      Merge from mysql-5.1.34-release
    ------------------------------------------------------------
    revno: 2828.8.3
    tags: mysql-5.1.34
    committer: Jonathan Perkin <jperkin@sun.com>
    branch nick: mysql-5.1.34-release
    timestamp: Thu 2009-04-02 13:17:38 +0200
    message:
      Apply http://lists.mysql.com/commits/70427 to fix Win32 builds with VS 2005.
